// בדיקת בעיות פיסוק וצמידות גרשיים
function testPunctuationIssues() {
  console.log('🧪 Testing punctuation and quotation proximity issues...');

  const problemText = `
הוא אמר"אני הולך הביתה".
הספר"תורה" נמצא על השולחן.
"מה אתה אומר"שאל הרב.
הם קראו"שמע ישראל".היום.
"ברוך השם"אמר הילד"בכל יום".
הילד אמר"אבא"ואז הלך.בערב.
"זה יפה"השיב"תודה רבה".אמש.
אמר"שלום."והלך.
`;

  console.log('לפני תיקון:');
  console.log(problemText);

  let text = problemText
    // תיקון 1xxxxxxxxxxxxחים צמודים למילה (מילה"משהו -> מילה "משהו)
    .replace(/([א-ת])"([א-ת])/g, '$1 "$2')

    // תיקון 2: גרשיים סוגרים צמודים למילה הבאה ("משהו"מילה -> "משהו" מילה)
    .replace(/"([א-ת])/g, '" $1')

    // תיקון 3: נקודה אחרי גרשיים צריכה להיות לפני (מילה." -> מילה".)
    .replace(/([א-ת])\\."/g, '$1".')

    // תיקון 4: נקודה אחרי גרשיים צמודה למילה ("משהו".מילה -> "משהו". מילה)
    .replace(/"\\.([א-ת])/g, '". $1')

    // תיקון 5: פיסוק אחר אחרי גרשיים צמוד למילה ("משהו",מילה -> "משהו", מילה)
    .replace(/"([.,!?:;])([א-ת])/g, '"$1 $2')

    // תיקון 6: פיסוק אחר שצריך להיות לפני גרשיים (מילה," -> מילה",)
    .replace(/([א-ת]),"/g, '$1",')
    .replace(/([א-ת])!"/g, '$1"!')
    .replace(/([א-ת])\\?"/g, '$1"?')
    .replace(/([א-ת]):"/g, '$1":')
    .replace(/([א-ת]);"/g, '$1";')

    // ניקוי רווחים מיותרים
    .replace(/\\s{2,}/g, ' ')
    .trim();

  console.log('\\nאחרי תיקון:');
  console.log(text);

  console.log('\\n=== ציפיות ===');
  console.log('✅ הוא אמר "אני הולך הביתה".');
  console.log('✅ הספר "תורה" נמצא על השולחן.');
  console.log('✅ "מה אתה אומר" שאל הרב.');
  console.log('✅ הם קראו "שמע ישראל". היום.');
  console.log('✅ "ברוך השם" אמר הילד "בכל יום".');
  console.log('✅ הילד אמר "אבא" ואז הלך. בערב.');
  console.log('✅ "זה יפה" השיב "תודה רבה". אמש.');
  console.log('✅ אמר "שלום". והלך.');
}

testPunctuationIssues();