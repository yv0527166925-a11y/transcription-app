// פתרון סופי לבעיות פיסוק וצמידות גרשיים
function finalPunctuationSolution() {
  console.log('🧪 Final solution for punctuation and quotation issues...');

  const testCases = [
    'הוא אמר"אני הולך הביתה".',
    'הספר"תורה" נמצא על השולחן.',
    '"מה אתה אומר"שאל הרב.',
    'אמר"שלום."והלך.',
    'הם קראו"שמע ישראל".היום.',
    '"ברוך השם"אמר הילד.',
  ];

  testCases.forEach((testCase, index) => {
    console.log(`\\n--- Test ${index + 1} ---`);
    console.log('לפני:', testCase);

    let text = testCase;

    // **גישה חדשה: טיפול נפרד בכל סוג בעיה**

    // 1. תיקון נקודה במקום הלא נכון תחילה (לפני התערבויות אחרות)
    text = text.replace(/([א-ת])\\."/g, '$1".');

    // 2. גרשיים פותחים צמודים למילה (מילה"טקסט -> מילה "טקסט)
    // רק כאשר אין רווח לפני המילה הראשונה
    text = text.replace(/([א-ת])"([א-ת][^"]*)/g, '$1 "$2');

    // 3. גרשיים סוגרים עם פיסוק צמודים למילה (."מילה -> ". מילה)
    text = text.replace(/"\\.([א-ת])/g, '". $1');

    // 4. גרשיים סוגרים רגילים צמודים למילה ("טקסט"מילה -> "טקסט" מילה)
    // אבל רק אם לא טיפלנו בזה כבר
    text = text.replace(/([א-ת][^"\\.])"([א-ת])/g, '$1" $2');

    console.log('אחרי:', text);

    // הציג מה היינו מצפים לקבל
    const expected = [
      'הוא אמר "אני הולך הביתה".',
      'הספר "תורה" נמצא על השולחן.',
      '"מה אתה אומר" שאל הרב.',
      'אמר "שלום". והלך.',
      'הם קראו "שמע ישראל". היום.',
      '"ברוך השם" אמר הילד.',
    ];

    console.log('ציפיה:', expected[index]);
    console.log('✅ תקין:', text === expected[index] ? 'כן' : 'לא');
  });

  console.log('\\n📋 הפתרון הסופי:');
  console.log('1. תיקון נקודה במקום הלא נכון: /([א-ת])\\\\."/g -> $1".');
  console.log('2. רווח לפני גרשיים פותחים: /([א-ת])"([א-ת][^"]*)/g -> $1 "$2');
  console.log('3. רווח אחרי גרשיים+נקודה: /"\\\\.([א-ת])/g -> ". $1');
  console.log('4. רווח אחרי גרשיים סוגרים: /([א-ת][^".)])"([א-ת])/g -> $1" $2');
}

finalPunctuationSolution();