// בדיקת בעיות פיסוק וצמידות גרשיים - גרסה מתוקנת
function testPunctuationFixed() {
  console.log('🧪 Testing punctuation and quotation proximity issues - FIXED...');

  const problemText = `
הוא אמר"אני הולך הביתה".
הספר"תורה" נמצא על השולחן.
"מה אתה אומר"שאל הרב.
הם קראו"שמע ישראל".היום.
"ברוך השם"אמר הילד"בכל יום".
הילד אמר"אבא"ואז הלך.בערב.
"זה יפה"השיב"תודה רבה".אמש.
אמר"שלום."והלך.
`;

  console.log('לפני תיקון:');
  console.log(problemText);

  let text = problemText
    // שלב 1: תיקון נקודה שנמצאת אחרי גרשיים (צריכה להיות לפני)
    .replace(/([א-ת])\\."([א-ת])/g, '$1". $2')  // מילה."מילה -> מילה". מילה
    .replace(/([א-ת])\\."/g, '$1".')              // מילה." -> מילה".

    // שלב 2: הוספת רווח לפני גרשיים פותחים כשהם צמודים למילה
    .replace(/([א-ת])"([א-ת][^"]*)/g, '$1 "$2')  // מילה"טקסט -> מילה "טקסט

    // שלב 3: הוספת רווח אחרי גרשיים סוגרים כשהם צמודים למילה
    .replace(/([^\\s])"([א-ת])/g, '$1" $2')       // טקסט"מילה -> טקסט" מילה

    // שלב 4: נקודה אחרי גרשיים צמודה למילה
    .replace(/"\\.([א-ת])/g, '". $1')             // טקסט".מילה -> טקסט". מילה

    // ניקוי רווחים מיותרים
    .replace(/\\s{2,}/g, ' ')
    .trim();

  console.log('\\nאחרי תיקון:');
  console.log(text);

  console.log('\\n=== ציפיות ===');
  console.log('✅ הוא אמר "אני הולך הביתה".');
  console.log('✅ הספר "תורה" נמצא על השולחן.');
  console.log('✅ "מה אתה אומר" שאל הרב.');
  console.log('✅ הם קראו "שמע ישראל". היום.');
  console.log('✅ "ברוך השם" אמר הילד "בכל יום".');
  console.log('✅ הילד אמר "אבא" ואז הלך. בערב.');
  console.log('✅ "זה יפה" השיב "תודה רבה". אמש.');
  console.log('✅ אמר "שלום". והלך.');
}

testPunctuationFixed();