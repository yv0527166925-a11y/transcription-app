// בדיקה מקיפה של כל הבעיות העבריות שהמשתמש דיווח עליהן
function testComprehensiveHebrew() {
  console.log('🧪 Testing comprehensive Hebrew issues from user reports...');

  const userProblems = [
    'חז "ל רש "י ה "אוהב ישראל"',
    '"מה החזיר אותך בתשובה?"סיפר את הסיפור הזה',
    'רש" י  ה "אוהב ישראל"   "וכל מדוי מצרים... לא ישימם בך" ]יורד שורה הפסוק]  את הארץ."  אני לא יודעתראו',
    'שליט" א  אמינים האר\'י ז" ל חז "לים ב "צילא דמהימנותא" הוא יפרע ממי שאינו עומד בדיבורו." ה "אור החיים" העילוי של הישיבה הוא בדף ל\', אתה בק" ב.'
  ];

  userProblems.forEach((problemText, index) => {
    console.log(`\\n=== בדיקה ${index + 1} ===`);
    console.log('לפני תיקון:');
    console.log(problemText);

    // העתק הקוד המלא מהשרת (גרסה מקוצרת)
    let text = problemText
      // שלב 1: תיקון קיצורים עבריים בסיסיים
      .replace(/רש\\s*["\\u0022\\u201C\\u201D]\\s*י/g, 'רש"י')
      .replace(/חז\\s*["\\u0022\\u201C\\u201D]\\s*ל/g, 'חז"ל')
      .replace(/שליט\\s*["\\u0022\\u201C\\u201D]\\s*א/g, 'שליט"א')
      .replace(/החיד\\s*["\\u0022\\u201C\\u201D]\\s*א/g, 'החיד"א')
      .replace(/הגר\\s*["\\u0022\\u201C\\u201D]\\s*א/g, 'הגר"א')
      .replace(/רמב\\s*["\\u0022\\u201C\\u201D]\\s*ם/g, 'רמב"ם')
      .replace(/רמב\\s*["\\u0022\\u201C\\u201D]\\s*ן/g, 'רמב"ן')
      .replace(/משנ\\s*["\\u0022\\u201C\\u201D]\\s*ב/g, 'משנ"ב')
      .replace(/שו\\s*["\\u0022\\u201C\\u201D]\\s*ע/g, 'שו"ע')
      .replace(/שו\\s*["\\u0022\\u201C\\u201D]\\s*ת/g, 'שו"ת')
      .replace(/מהר\\s*["\\u0022\\u201C\\u201D]\\s*ל/g, 'מהר"ל')
      .replace(/בק\\s*"\\s*ב/g, 'בק"ב')
      .replace(/ב\\s*"\\s*ה/g, 'ב"ה')
      .replace(/ד\\s*"\\s*ה/g, 'ד"ה')

      // שלב 2: תיקון קיצורים שכבר נפרדו
      .replace(/חז\\s+"\\s*ל/g, 'חז"ל')
      .replace(/רש\\s+"\\s*י/g, 'רש"י')
      .replace(/האר['׳]\\s*י\\s+ז\\s*"\\s*ל/g, 'האר"י ז"ל')

      // שלב 3: מילים שמתחלקות עם גרשיים
      .replace(/חזלי\\s*"\\s*ם/g, 'חז"לים')
      .replace(/חז\\s+"\\s*לים/g, 'חז"לים')
      .replace(/חז\\s*"\\s*לים/g, 'חז"לים')
      .replace(/חכמי\\s*"\\s*ם/g, 'חכמים')
      .replace(/אמיני\\s*ם/g, 'אמנים')

      // שלב 4: מיתוקים שגויים
      .replace(/אמן-ים/g, 'אמנים')
      .replace(/בן-אדם/g, 'בן אדם')
      .replace(/יהודי-ים/g, 'יהודים')

      // שלב 5: ניקוי גרשיים
      .replace(/["\\u0022\\u201C\\u201D]/g, '"')

      // שלב 6: תיקון גרשיים סביב שמות
      .replace(/ה\\s+"([^"]+)"/g, 'ה"$1"')
      .replace(/([א-ת])\\s+"([^"]+)"/g, '$1"$2"')

      // שלב 7: גרשיים סוגרים צמודים למילה הבאה
      .replace(/([.,!?])"([א-ת])/g, '$1" $2')
      .replace(/([א-ת])"([א-ת])/g, '$1" $2')

      // שלב 8: מילים צמודות
      .replace(/יודעתראו/g, 'יודעת ראו')
      .replace(/אומרתאני/g, 'אומרת אני')
      .replace(/שאלתיאותו/g, 'שאלתי אותו')
      .replace(/אמרתיכן/g, 'אמרתי כן')

      // שלב 9: תיקון פיסוק
      .replace(/\\s+([.,!?:;])/g, '$1')
      .replace(/([.,!?:;])\\s+/g, '$1 ')

      // שלב 10: ניקוי רווחים
      .replace(/\\s{2,}/g, ' ')
      .replace(/^\\s+|\\s+$/gm, '')
      .trim();

    console.log('\\nאחרי תיקון:');
    console.log(text);
  });

  console.log('\\n=== סיכום ציפיות ===');
  console.log('✅ רש"י (ללא רווח)');
  console.log('✅ חז"ל (ללא רווח)');
  console.log('✅ ה"אוהב ישראל" (ללא רווח לפני השם)');
  console.log('✅ "בתשובה?" סיפר (רווח אחרי גרשיים סוגרים)');
  console.log('✅ יודעת ראו (מילים נפרדות)');
  console.log('✅ אמנים (לא אמינים)');
  console.log('✅ חז"לים (לא חז "לים)');
  console.log('✅ בק"ב (ללא רווח)');
}

testComprehensiveHebrew();